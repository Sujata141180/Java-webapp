version: 2.1
orbs:
  maven: circleci/maven@1.1
commands: # a reusable command with parameters
  hello-function:
    parameters:
      to:
        default: "India"
        type: string
    steps:
      - run: echo "Hello from <<parameters.to>>"
jobs:
  my-job:
    docker:
      - image: cimg/base:stable     
    steps:
      - hello-function:
          to: "India"
  
  test2:
    working_directory: ~/test
    environment:
      NODE_ENV: "circle"
    docker:
      - image: circleci/node:10.16.3-stretch
    steps:
      - checkout
      - run:
          command: ls -ltrh
      - run:
          command: dir 
      - run:
          command: |
            chmod 777 .circleci/hello.sh
            .circleci/hello.sh
  maven-test:
    working_directory: ~/test
    environment:
      NODE_ENV: "circle"
    docker:
      - image: cimg/openjdk:11.0
    steps:
      # Checkout the code as the first step.
      - checkout
      # Use mvn clean and package as the standard maven build phase
      - run:
          name: Build
          command: mvn -B -DskipTests clean package
      # Then run your tests!
      - run:
          name: Test
          command: mvn test
workflows:
  my-workflow:
    jobs:
     - my-job:
        type: approval
     - test2:
        requires:
          - my-job
  maven-test:
    jobs:
      - maven-test
    
